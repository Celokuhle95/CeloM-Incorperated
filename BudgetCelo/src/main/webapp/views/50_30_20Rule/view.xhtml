<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core">
<ui:composition >
	<br/>
	<br/>
	<h:form id="FifthyThirthy20RuleForm">
		<p:panel header="Budget Rule Summary"
				 styleClass="sectionPanel"
				 toggleable="true"
				 rendered="#{monthlyBudgetController.isMonthlyBudgetValid()}"
				 >
			<f:facet name="header">
				<span class="panelHeader"> Budget Rule Summary </span>
			</f:facet>
			<div>
				<p:selectBooleanButton offLabel="Show" onLabel="Hide"
					rendered="#{monthlyBudgetController.isView()}"
					onIcon="ui-icon-close" offIcon="ui-icon-check">
					<p:ajax
						listener="#{visibilityController.toggleShowRuleSensitiveInfo()}"
						update=":FifthyThirthy20RuleForm" />

				</p:selectBooleanButton>
			</div>
			
			<br/>	 
				 
			<p:dataTable value="#{budgetRuleController.rules}" var="rule" > 
				<p:column styleClass="centered optionCol" headerText="Limit">
					<p:outputLabel value="#{rule.valueFormated}%" />
				</p:column>
				<p:column styleClass="centered" headerText="Calculated Income Percentage (R)">
					<p:outputLabel value="#{budgetRuleController.limitPercentageAmountFormated(rule)}" rendered="#{visibilityController.showRuleSensitiveInfo}"/>
					<p:outputLabel value="#{visibilityController.disguiser()}" rendered="#{visibilityController.showRuleSensitiveInfo eq false}"/>
				</p:column>
				<p:column styleClass="centered" headerText="Actual Budgeted Total (R)">
					<p:outputLabel 
						value="#{budgetRuleController.respectiveSpendingAmountFormated(rule)}" 
						rendered="#{visibilityController.showRuleSensitiveInfo}"
						/>
					<p:outputLabel value="#{visibilityController.disguiser()}" rendered="#{visibilityController.showRuleSensitiveInfo eq false}"/>
				</p:column>
				<p:column styleClass="centered" headerText="Difference (%)">
					<p:outputLabel style="color: #{budgetRuleController.textColor(rule)}"
						value="#{budgetRuleController.differencePercentageFormated(rule)}"/>
				</p:column>
				<p:column styleClass="optionCol centered" headerText="Explanation">
					<p:commandButton value="view" id="description"
						styleClass="autoWidth" title="For #{rule.summary}"/>
					<p:overlayPanel for="description">
						<p:outputLabel value="#{rule.description}" />
					</p:overlayPanel>
				</p:column>
			</p:dataTable>
			
			<br/>
			<br/>
			
			<script >
				function ext() {
				    this.cfg.seriesDefaults.rendererOptions = {
				        barWidth : 90
				    };
				}
			</script>
			
			<div>
				<p:commandButton title="Refesh"
								 icon="ui-icon-refresh"
								 update=":FifthyThirthy20RuleForm"
								 ajax="true"
								 rendered="#{visibilityController.showRuleSensitiveInfo}">
					<f:setPropertyActionListener value="#{monthlyBudgetController.monthlyBudget}"
									target="#{budgetRuleController.monthlyBudget}"/>
			 	</p:commandButton>
			</div>
			
		 	<br/>
			
			<div id="ruleReport">
				<p:chart type="bar" rendered="#{visibilityController.showRuleSensitiveInfo}"
						 model="#{budgetRuleController.barChart}" 
						 responsive="true" 
						 />
			</div>
			
		</p:panel>
	</h:form>
</ui:composition>
</html>