<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core">
<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
	<title>List Monthly Budgets By Year</title>
</h:head>
<h:body>
	<ui:composition template="/views/templates/baseTemplate.xhtml">
		<ui:define name="pageHeader">
		<br></br>
		</ui:define>

		<ui:define name="content">
			<h:form id="listMonthlyBudgetForm">
				<div>
					<p:selectBooleanButton offLabel="Show" onLabel="Hide"
						onIcon="ui-icon-close" offIcon="ui-icon-check" title="Amounts">
						<p:ajax listener="#{visibilityController.toggleShowListBudgetsSensitiveInfo()}" 
								update=":listMonthlyBudgetForm"/>	
					</p:selectBooleanButton>
				</div>
				<br/>
				<div id="allMonths">
					<ui:repeat value="#{monthlyBudgetController.allBudgets}"
							   var="budgets">
						<p:panel header="#{budgets.get(0).year}" toggleable="true"
							styleClass="sectionPanel">
							<p:dataTable value="#{budgets}" var="monthlyBudget">
								<p:column headerText="Month" styleClass="centered">
									<p:outputLabel value="#{monthlyBudget.month.toString()}" styleClass="centered"/>
								</p:column>
								<p:column headerText="Total Income" styleClass="centered">
									<p:outputLabel value="R#{monthlyBudget.totalIncomeFormated}" rendered="#{visibilityController.showListBudgetsSensitiveInfo}"/>
									<p:outputLabel value="#{visibilityController.disguiser()}" rendered="#{visibilityController.showListBudgetsSensitiveInfo eq false}"/>
								</p:column>
								<p:column headerText="Total Expenses" styleClass="centered">
									<p:outputLabel value="R#{monthlyBudget.totalExpensesFormated}" rendered="#{visibilityController.showListBudgetsSensitiveInfo}"/>
									<p:outputLabel value="#{visibilityController.disguiser()}" rendered="#{visibilityController.showListBudgetsSensitiveInfo eq false}"/>
								</p:column>
								<p:column headerText="Total Investments" styleClass="centered">
									<p:outputLabel
										rendered="#{visibilityController.showListBudgetsSensitiveInfo}"
										value="R#{monthlyBudget.totalInvestmentsFormated}" />
									<p:outputLabel value="#{visibilityController.disguiser()}" rendered="#{visibilityController.showListBudgetsSensitiveInfo eq false}"/>
								</p:column>
								<p:column headerText="Total Remaining" styleClass="centered">
									<p:outputLabel value="R#{monthlyBudget.totalMoneyLeftFormated}" rendered="#{visibilityController.showListBudgetsSensitiveInfo}"/>
									<p:outputLabel value="#{visibilityController.disguiser()}"  rendered="#{visibilityController.showListBudgetsSensitiveInfo eq false}"/>
								</p:column>
								<p:column headerText="Details" styleClass="optionCol centered">
									<p:commandButton value="view" action="#{monthlyBudgetController.goToView()}">
										<f:ajax listener="#{visibilityController.hideAllSensitiveInfo()}"/>
										<f:setPropertyActionListener value="#{monthlyBudget}" 
																	target="#{monthlyBudgetController.monthlyBudget}"/>
										<f:setPropertyActionListener value="#{monthlyBudget}" 
																	target="#{budgetRuleController.monthlyBudget}"/>
																
									 </p:commandButton>
								</p:column>
								<p:column headerText="Delete" styleClass="optionCol centered">
									<p:commandButton action="#{monthlyBudgetController.delete(monthlyBudget)}"
													 icon="ui-icon-trash"
													 ajax="true"
													 update=":listMonthlyBudgetForm">
										 <p:confirm header="Confirmation" message="Are you sure you want to permanently delete this budget?"
													icon="ui-icon-alert" />
									 </p:commandButton>
							   </p:column>
							</p:dataTable>
						</p:panel>
						<br/>
						<br/>
					</ui:repeat>
				</div>
			</h:form>
		</ui:define>

	</ui:composition>
</h:body>
</html>